2025-12-11 08:52:07 - **** Job starts ****
2025-12-11 08:52:07 - **** Bridges-2 info ****
User: kbenjamin
Job id: 36499006
Job name: phase_two_pop
Node name: 
Hostname: r325
Task id: 2

Currently Loaded Modules:
  1) anaconda3/2024.10-1

 

2025-12-11 08:52:07 - **** Loading conda environment ****
2025-12-11 08:52:08 - **** Run analysis ****
2025-12-11 08:52:11,475 [INFO] Phase RFMix outputs per chromosome...
2025-12-11 08:52:11,685 [INFO] [phase_rfmix_chromosome_to_zarr] Starting phasing for chrom=2 into /ocean/projects/bio250020p/kbenjamin/projects/rfmix_reader-benchmarking/input/simulations/two_populations/_m/rfmix-out/phased_files/phased_chr2.zarr
Multiple RFMIX file sets read in this order: ['chr1', 'chr10', 'chr11', 'chr12', 'chr13', 'chr14', 'chr15', 'chr16', 'chr17', 'chr18', 'chr19', 'chr2', 'chr20', 'chr21', 'chr22', 'chr3', 'chr4', 'chr5', 'chr6', 'chr7', 'chr8', 'chr9']
Mapping loci information:   0%|          | 0/1 [00:00<?, ?it/s]Mapping loci information: 100%|██████████| 1/1 [02:02<00:00, 122.36s/it]Mapping loci information: 100%|██████████| 1/1 [02:02<00:00, 122.36s/it]
Mapping global ancestry files:   0%|          | 0/1 [00:00<?, ?it/s]Mapping global ancestry files: 100%|██████████| 1/1 [00:00<00:00, 28.93it/s]
Mapping local ancestry files:   0%|          | 0/1 [00:00<?, ?it/s]Mapping local ancestry files: 100%|██████████| 1/1 [00:00<00:00,  1.36it/s]Mapping local ancestry files: 100%|██████████| 1/1 [00:00<00:00,  1.36it/s]
2025-12-11 08:54:14,922 [INFO] [phase_rfmix_chromosome_to_zarr] Loaded 1063527 variants across 500 samples
/ocean/projects/bio250020p/kbenjamin/software/rfmix_reader/rfmix_reader/processing/phase.py:625: RuntimeWarning: Failed to open Zarr store with consolidated metadata, but successfully read with non-consolidated metadata. This is typically much slower for opening a dataset. To silence this warning, consider:
1. Consolidating metadata in this existing store with zarr.consolidate_metadata().
2. Explicitly setting consolidated=False, to avoid trying to read consolidate metadata, or
3. Explicitly setting consolidated=True, to raise an error in this case instead of falling back to try reading non-consolidated metadata.
  ds = xr.open_zarr(zarr_path)
Traceback (most recent call last):
  File "/ocean/projects/bio250020p/kbenjamin/projects/rfmix_reader-benchmarking/loci_imputation_comp/_m/../_h/02.phase_data.py", line 49, in <module>
    main()
  File "/ocean/projects/bio250020p/kbenjamin/projects/rfmix_reader-benchmarking/loci_imputation_comp/_m/../_h/02.phase_data.py", line 35, in main
    _ = phase_rfmix_chromosome_to_zarr(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ocean/projects/bio250020p/kbenjamin/software/rfmix_reader/rfmix_reader/processing/phase.py", line 1164, in phase_rfmix_chromosome_to_zarr
    phased = phase_admix_dask_with_index(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ocean/projects/bio250020p/kbenjamin/software/rfmix_reader/rfmix_reader/processing/phase.py", line 1025, in phase_admix_dask_with_index
    refs, group_labels, _match_stats = build_reference_haplotypes_from_zarr(
                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ocean/projects/bio250020p/kbenjamin/software/rfmix_reader/rfmix_reader/processing/phase.py", line 655, in build_reference_haplotypes_from_zarr
    raise KeyError(
KeyError: "Zarr store missing 'variant_position' (or 'variants/POS'). This does not look like a VCF-Zarr store."
Python script failed. Check the error logs.
