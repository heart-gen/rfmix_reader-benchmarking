2025-09-29 23:56:20 - **** Job starts ****
2025-09-29 23:56:20 - **** Quest info ****
User: owb0346
Job id: 5337649
Job name: simu_3pops
Node name: 
Hostname: qnode2168
Task id: 17
2025-09-29 23:56:20 - **** Loading modules ****

Currently Loaded Modules:
  1) bzip2/1.0.8-gcc-4.8.5   3) openssl/1.0.2k-gcc-4.8.5
  2) htslib/1.16             4) bcftools/1.10.1

 

2025-09-29 23:56:28 - **** Loading mamba environment ****
2025-09-29 23:56:36 - **** Generate VCF contigs for header ****
**** Run simulation ****
[    INFO] Using seed 20240126 (sim_genotype.py:359)
[    INFO] Simulating generation 1 (sim_genotype.py:457)
[    INFO] Simulating generation 2 (sim_genotype.py:463)
[    INFO] Simulating generation 3 (sim_genotype.py:463)
[    INFO] Simulating generation 4 (sim_genotype.py:463)
[    INFO] Simulating generation 5 (sim_genotype.py:463)
[    INFO] Simulating generation 6 (sim_genotype.py:463)
[    INFO] Simulating generation 7 (sim_genotype.py:463)
[    INFO] Simulating generation 8 (sim_genotype.py:463)
[    INFO] Simulating generation 9 (sim_genotype.py:463)
[    INFO] Simulating generation 10 (sim_genotype.py:463)
[    INFO] Outputting breakpoint file temp/chr17.bp (sim_genotype.py:503)
[    INFO] Outputting file temp/chr17.vcf.gz (sim_genotype.py:75)
[ WARNING] The max_variants parameter was not specified. We have no choice but to append to an ever-growing array, which can lead to memory overuse! (genotypes.py:165)
[    INFO] Loading genotypes from 3202 samples (genotypes.py:289)
[    INFO] Copying 1767777 variants into np arrays. (genotypes.py:174)
[    INFO] Transposing genotype matrix of size (1767777, 3202, 3) (genotypes.py:209)
[    INFO] Writing VCF records (transform.py:483)
Traceback (most recent call last):
  File "/projects/p32505/opt/envs/ml/bin/haptools", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/gpfs/projects/p32505/opt/envs/ml/lib/python3.12/site-packages/click/core.py", line 1462, in __call__
    return self.main(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/projects/p32505/opt/envs/ml/lib/python3.12/site-packages/click/core.py", line 1383, in main
    rv = self.invoke(ctx)
         ^^^^^^^^^^^^^^^^
  File "/gpfs/projects/p32505/opt/envs/ml/lib/python3.12/site-packages/click/core.py", line 1850, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/projects/p32505/opt/envs/ml/lib/python3.12/site-packages/click/core.py", line 1246, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/projects/p32505/opt/envs/ml/lib/python3.12/site-packages/click/core.py", line 814, in invoke
    return callback(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/projects/p32505/opt/envs/ml/lib/python3.12/site-packages/haptools/__main__.py", line 298, in simgenotype
    output_vcf(
  File "/gpfs/projects/p32505/opt/envs/ml/lib/python3.12/site-packages/haptools/sim_genotype.py", line 223, in output_vcf
    gts.write()
  File "/gpfs/projects/p32505/opt/envs/ml/lib/python3.12/site-packages/haptools/transform.py", line 501, in write
    record.samples[sample]["GT"] = tuple(self.data[samp_idx, var_idx, :2])
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "pysam/libcbcf.pyx", line 3542, in pysam.libcbcf.VariantRecordSample.__setitem__
  File "pysam/libcbcf.pyx", line 872, in pysam.libcbcf.bcf_format_set_value
  File "pysam/libcbcf.pyx", line 671, in pysam.libcbcf.bcf_encode_alleles
ValueError: Invalid allele index
2025-09-30 00:45:09 - **** Annotate VCF ****
2025-09-30 00:46:16 - **** Job ends ****
